@{
    var roleName = ViewBag.RoleName as string; // Retrieve the role name from ViewBag
    var id = ViewBag.DocenteId as string; // Retrieve the role name from ViewBag
}


@model IEnumerable<ExpedienteCompletoNino>

<div class="dashboard-body">

    <div class="breadcrumb-with-buttons mb-24 flex-between flex-wrap gap-8">
        <!-- Breadcrumb Start -->
        <div class="breadcrumb mb-24">
            <ul class="flex-align gap-4">
                <li>
                    <a asp-action="Index" asp-controller="Home" class="text-gray-200 fw-normal text-15 hover-text-main-600">Inicio</a>
                </li>
                <li>
                    <span class="text-gray-500 fw-normal d-flex">
                        <i class="ph ph-caret-right"></i>
                    </span>
                </li>
                <li>
                    <span class="text-main-600 fw-normal text-15">Expedientes</span>
                </li>
            </ul>
        </div>
        <!-- Breadcrumb End -->
    </div>


    <div class="card overflow-hidden">
        <div class="card-body p-0 overflow-x-auto">
            <table id="studentTable" class="table table-striped">
                <thead>
                <tr>
                    <th class="fixed-width">
                        <div class="form-check">
                            <input class="form-check-input border-gray-200 rounded-4" type="checkbox" id="selectAll">
                        </div>
                    </th>
                    <th class="h6 text-gray-300">Nombre</th>
                    <th class="h6 text-gray-300">Cédula</th>
                    <th class="h6 text-gray-300">Fecha de Nacimiento</th>
                    <th class="h6 text-gray-300">Dirección</th>
                    <th class="h6 text-gray-300">Póliza</th>
                    <th class="h6 text-gray-300"></th>
                </tr>
                </thead>
                <tbody>
                @foreach (var expediente in Model)
                {
                    <tr>
                        <td class="fixed-width">
                            <div class="form-check">
                                <input class="form-check-input border-gray-200 rounded-4" type="checkbox">
                            </div>
                        </td>
                        <td>
                            <div class="flex-align gap-8">
                                <img src="~/images/icons/baby_2_icon.png" alt="Imagen del niño" class="w-40 h-40 rounded-circle">
                                <span class="h6 mb-0 fw-medium text-gray-300">@expediente.NombreNino</span>
                            </div>
                        </td>
                        <td>
                            <span class="h6 mb-0 fw-medium text-gray-300">@expediente.Cedula</span>
                        </td>
                        <td>
                            <span class="h6 mb-0 fw-medium text-gray-300">@expediente.FechaNacimiento.ToString("dd/MM/yyyy")</span>
                        </td>
                        <td>
                            <span class="h6 mb-0 fw-medium text-gray-300">@id</span>
                        </td>
                        <td>
                            <span class="text-13 py-2 px-8 bg-warning-50 text-warning-600 d-inline-flex align-items-center gap-8 rounded-pill">
                                <span class="w-6 h-6 bg-warning-600 rounded-circle flex-shrink-0"></span>
                                @expediente.Poliza
                            </span>
                        </td>
                        @if (roleName == "Administrador") {
                        <td>
                            <a asp-action="Details_Admin" asp-route-id="@expediente.IdNino" asp-controller="Ninos" class="bg-main-50 text-main-600 py-2 px-14 rounded-pill hover-bg-main-600 hover-text-white">Ver Más</a>
                        </td>
                        } else {
                            <td>
                                <a asp-action="Details_Docente" asp-controller="Ninos" asp-route-id="@expediente.IdNino" asp-route-idDocente="@ViewBag.DocenteId" class="bg-main-50 text-main-600 py-2 px-14 rounded-pill hover-bg-main-600 hover-text-white">Ver Más</a>
                                <form asp-action="EliminarRelacion" asp-controller="Asistencia" asp-route-idNino="@expediente.IdNino" method="post" class="d-inline" onsubmit="return confirm('¿Estás seguro de que deseas eliminar esta relación?');">
                                    <button type="submit" class="btn btn-danger py-2 px-14 rounded-pill">Eliminar</button>
                                </form>
                            </td>
                        }
                    </tr>
                }       
                </tbody>
            </table>
        </div>
        <div class="card-footer flex-between flex-wrap">
            <span id="entriesInfo" class="text-gray-900"></span>
            <select id="entriesSelect" class="form-select">
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="50">50</option>
            </select>
        </div>
    </div>

    <!-- Modal for additional details -->
    <div class="modal fade" id="expedienteModal" tabindex="-1" aria-labelledby="expedienteModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="expedienteModalLabel">Detalles del Expediente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p><strong>Nombre del Niño:</strong> <span id="modalNombre"></span></p>
                    <p><strong>Fecha de Nacimiento:</strong> <span id="modalFechaNacimiento"></span></p>
                    <p><strong>Dirección:</strong> <span id="modalDireccion"></span></p>
                    <p><strong>Póliza:</strong> <span id="modalPoliza"></span></p>
                    <p><strong>Alergia:</strong> <span id="modalNombreAlergia"></span></p>
                    <p><strong>Condición:</strong> <span id="modalNombreCondicion"></span></p>
                    <p><strong>Medicamento:</strong> <span id="modalNombreMedicamento"></span></p>
                    <p><strong>Dosis:</strong> <span id="modalDosis"></span></p>
                    <p><strong>Contacto de Emergencia:</strong> <span id="modalNombreContacto"></span></p>
                    <p><strong>Teléfono de Contacto:</strong> <span id="modalTelefonoContacto"></span></p>
                    <p><strong>Relación del Contacto:</strong> <span id="modalRelacionContacto"></span></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>


    <script src="~/js/users_scripts/manageRecords/export.js"></script>
    <script src="~/js/users_scripts/manageRecords/tableCheckbox.js"></script>
    <script src="~/js/users_scripts/manageRecords/dataTableConfig.js"></script>
    <script src="~/js/users_scripts/manageRecords/viewMoreModal.js"></script>
</div>